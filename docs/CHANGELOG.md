# Changelog

## 2026-01-05
- Added `docs/DELETION_MUTANTS_PLAN.md` outlining the deletion mutant daily puzzle port.
- Added the new daily puzzle page `site_docs/daily_puzzles/deletion_mutants.md`.
- Added short "why this matters" blurbs to the daily puzzle pages for Peptidyle and deletion mutants.
- Added shared browser utilities `site_docs/assets/scripts/daily_puzzle_core.js` and `site_docs/assets/scripts/daily_puzzle_stats.js`.
- Added deletion mutant puzzle JS/CSS assets under `site_docs/assets/scripts/` and `site_docs/assets/stylesheets/`.
- Tweaked deletion mutant UI: stronger table borders, visible empty guess grid, and an optional first-gene hint with a guess penalty.
- Tweaked daily puzzle UI: shared pill-style stats/streak display and deletion-table styling closer to the original deletion mutant tables.
- Refined deletion mutant daily puzzle styling: pastel deletions in light mode, dark deletions in dark mode, better empty-cell fills, hint button styling, and reduced perceived whitespace around the game area.
- Reduced the size of the "I need help" hint UI in the deletion mutant daily puzzle.
- Widened deletion mutant table columns for readability.
- Refactored deletion mutant theme switching to use MkDocs Material `data-md-color-scheme` CSS variables (no JS re-render on toggle).
- Improved daily puzzle theme integration: scheme-aware deletion colors via CSS, Material token-based surfaces/borders, focus-visible outlines, and reduced-motion scrolling.
- Updated invalid (red) on-screen keyboard keys to render as dark red in dark mode.
- Added shared `site_docs/assets/scripts/daily_puzzle_keyboard.js` and refactored both daily puzzles to use it.
- Added shared physical keyboard input controller `site_docs/assets/scripts/daily_puzzle_input.js` and refactored both puzzles to use it.
- Hardened `site_docs/assets/scripts/daily_puzzle_input.js` to avoid duplicate listeners across reloads and to ignore contenteditable ancestors (e.g. MkDocs search/widgets).
- Made `site_docs/assets/scripts/daily_puzzle_input.js` merge install options to avoid accidental handler loss; strengthened slate-mode keyboard key foreground in `site_docs/assets/stylesheets/daily_puzzle.css`.
- Added a shared "next puzzle" countdown timer under both daily puzzle keyboards (updates once per minute; `aria-live="off"`).
- Improved deletion mutant layout: responsive table+legend columns, continuous deletion bars, and a non-reserved guess board to reduce whitespace before play.
- Moved the deletion mutant help button into the same control row as the first-gene hint.
- Updated the shared on-screen keyboard: renamed disabled keys from `invalid` to `disabled`, added an option to soft-disable keys, and drove disabled-key colors via theme-switched CSS variables.
- Fixed deletion mutants page HTML rendering by removing leading indentation that caused Markdown to treat the UI as a code block.
- Fixed dark mode keyboard foreground and disabled-key dimming via shared keyboard CSS variables.
- Increased light-mode deletion bar saturation by using the light palette (instead of extra-light) for table fills.
- Improved deletion legend wrapping (flex rows with fixed labels) and made light-mode deletion colors more saturated.
- Added hard overrides to force keyboard glyph colors to switch correctly in slate mode (including Safari `-webkit-text-fill-color`).
- Fixed theme selector mismatch by switching MkDocs Material scheme selectors from `:root/html[...]` to `body[data-md-color-scheme=...]`.
- Aligned Peptidyle keyboard styling with the deletion mutants keyboard (container box + key borders).
- Added shared `site_docs/assets/scripts/daily_puzzle_ui.js` and shared `site_docs/assets/stylesheets/daily_puzzle.css`.
- Moved shared daily puzzle stats/keyboard/control-bar CSS out of `site_docs/assets/stylesheets/custom.css`.
- Updated Peptidyle UI: moved tips controls above the peptide image and added a first-letter hint with a 1-guess penalty.
- Updated both puzzles so the -1 first-letter hint consumes a visible guess row (first letter in green, rest blank) and is disabled when only 1 guess remains.
- Added the deletion mutant puzzle to `mkdocs.yml` nav and linked it from `site_docs/index.md`.
- Migrated Peptidyle stats to `site_docs/assets/scripts/daily_puzzle_stats.js` and removed `site_docs/assets/scripts/peptidyle_stats.js`.
- Renamed `site_docs/assets/scripts/deletion_mutants_colors.js` to `site_docs/assets/scripts/daily_puzzle_colors.js` for reuse across daily puzzles.
- Added `site_docs/assets/scripts/daily_puzzle_wordle.js` (shared Wordle scoring, board rendering, and toast helper) and refactored both daily puzzles to use it.
- Unified -1 hint behavior across both puzzles: hint is only available before the first guess, requires an empty current guess, consumes a guess via a visible penalty row, and pre-fills the current guess with the revealed first letter.
- Updated `site_docs/assets/scripts/peptidyle_words.js` to use `site_docs/assets/scripts/daily_puzzle_core.js` for daily selection/hashing (no duplicate hashing implementation).
- Added shared Wordle cell/board styling to `site_docs/assets/stylesheets/daily_puzzle.css` so both puzzles render the guess grid consistently (and the deletion mutant board has visible boxes).
- Increased light-mode deletion mutant palette saturation in `site_docs/assets/scripts/daily_puzzle_colors.js`.
- Extended `site_docs/assets/scripts/daily_puzzle_keyboard.js` click handling to support optional soft-disabled key toasts.
- Added `build_deletion_mutants_wordbank.py` and embedded the filtered unique-letter deletion-mutants word list directly in `site_docs/assets/scripts/deletion_mutants_words.js` (no runtime fetch required).

## 2026-01-03
- Added `bbq_control/bbq_config.yml` for path aliases, script aliases, and input defaults.
- Added an `input` column to `bbq_control/bbq_tasks.csv` and `bbq_control/sub_bbq_tasks.csv`.
- Updated BBQ task runners to expand aliases and attach input files from the new columns.
- Added `bbq_control/usage.txt` with BBQ task runner usage notes.
- Switched the main path alias to `{bp_root}` for shorter CSV entries.
- Allowed basename-only `input` values for YMWOMC/YMCS/YMMS tasks.
- Removed the `input_flag` column (inputs always use `-y`).

## 2025-12-27
- Added `bbq_sync_tasks.py` to sync BBQ outputs from biology-problems scripts with a task state CSV.
- Moved MkDocs content from `docs/` to `site_docs/` and set `docs_dir` in `mkdocs.yml`.
- Updated path references to the MkDocs content in `README.md`, `bbq_control/bbq_tasks.csv`, and helper scripts.
- Simplified `bbq_control/bbq_tasks.csv` to `chapter,topic,output_file,script,flags,notes` and updated runners to build output paths from chapter/topic.
- Added `--limit`, `--sort`, `--shuffle`, and `--seed` options to `run_bbq_tasks.py`.
- Updated the Textual TUI layout to put the task table full-width with a top metrics/log row.
- Fixed DataTable updates in the TUI to avoid row/column lookup errors.
- Adjusted TUI labels to show script names, tightened the metrics layout, and reduced the top row height.
- Moved the TUI "Press q to quit" prompt into the dashboard panel.
- Removed the TUI header bar and added a dashboard title line.
- Increased the TUI top row height to scale with terminal size while keeping a larger minimum height.
- Added `-x/--max-questions` to append a global max-questions flag to all scripts.
- Added a validation check that fails when a max-questions run produces too many lines.
- Truncate `logs/bbq_generation.log` at the start of each run.
- Added `-d/--duplicates` (default 99) and `--no-duplicates` to control global duplicate runs.
- Fixed dry-run validation to count lines from the newly generated output in the working directory.
- Clean up dry-run generated `bbq*.txt` outputs to avoid accumulation.
- Read the MkDocs `docs_dir` from `mkdocs.yml` when generating subject indexes and topic pages.
- Routed LLM title generation through `llm_wrapper.py` with quiet model calls.
- Removed shell-based subprocess usage from topic page generation.
- Removed unused imports flagged by pyflakes.
- Added `--no-tui` to force plain mode.
- Added `pip_requirements.txt` with `textual`.
- Fixed `run_bbq_tasks.py` to guard TUI class definitions when Textual is unavailable.
- Updated BBQ task runners to fail when outputs are missing or mismatched.
